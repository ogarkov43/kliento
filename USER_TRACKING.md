# Система отслеживания пользователей Telegram

Система автоматически отслеживает всех пользователей, которые присоединяются к Telegram боту.

## Что отслеживается

- **Telegram ID** - уникальный идентификатор пользователя
- **Имя** (first_name) - имя пользователя
- **Фамилия** (last_name) - фамилия пользователя (если есть)
- **Никнейм** (username) - @username пользователя (если есть)
- **Язык** (language_code) - языковой код пользователя
- **Дата присоединения** - когда пользователь впервые открыл приложение
- **Дата отслеживания** - когда данные были сохранены

## Как это работает

При каждом открытии приложения система автоматически:
1. Получает данные пользователя из Telegram WebApp API
2. Сохраняет их в localStorage браузера
3. Выводит информацию в консоль разработчика

## Просмотр отслеживаемых пользователей

### Вариант 1: Через консоль браузера

1. Откройте DevTools (F12 или Cmd+Option+I на Mac)
2. Перейдите во вкладку Console
3. Введите одну из команд:

```javascript
// Показать список всех пользователей в виде таблицы
window.printUsersToConsole()

// Получить статистику
window.getUsersStats()

// Экспортировать данные в JSON файл (автоматически скачается)
window.exportUsersToFile()
```

### Вариант 2: Экспорт данных в файл

Данные автоматически сохраняются в localStorage. Чтобы получить файл со всеми данными:

1. Откройте консоль браузера
2. Выполните: `window.exportUsersToFile()`
3. Файл `telegram-users-[дата].json` будет автоматически скачан

## Формат данных

Данные экспортируются в формате JSON:

```json
[
  {
    "id": 123456789,
    "firstName": "Иван",
    "lastName": "Иванов",
    "username": "ivan_ivanov",
    "languageCode": "ru",
    "joinedAt": "2025-01-16T10:30:00.000Z",
    "trackedAt": "2025-01-16T10:30:00.000Z"
  }
]
```

## Доступные функции

Все функции доступны через объект `window`:

- `window.trackCurrentUser()` - отследить текущего пользователя
- `window.getTelegramUser()` - получить данные текущего пользователя
- `window.getTrackedUsersFromLocalStorage()` - получить всех отслеживаемых пользователей
- `window.exportUsersToFile()` - экспортировать данные в JSON файл
- `window.getUsersStats()` - получить статистику
- `window.printUsersToConsole()` - вывести список в консоль
- `window.clearTrackedUsers()` - очистить все данные (осторожно!)

## Хранение данных

Данные хранятся в localStorage браузера под ключом `telegram_tracked_users`.

**Важно:** Данные хранятся локально в браузере. При очистке данных браузера они будут удалены.

## Интеграция с сервером

Если нужно отправлять данные на сервер, раскомментируйте код в функции `sendUserToServer()` в файле `src/utils/telegram.ts` и укажите URL вашего API endpoint.

```typescript
const response = await fetch('YOUR_API_ENDPOINT/users', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify(user),
});
```

## Автоматическое отслеживание

Отслеживание происходит автоматически при:
- Первой загрузке приложения
- Каждый раз, когда пользователь открывает приложение

Система проверяет, не сохранен ли уже пользователь, и обновляет его данные при необходимости.
